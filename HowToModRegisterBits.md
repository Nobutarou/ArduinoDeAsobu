# レジスタのビット書き換え

## 仕組み

PIC のように REGISTERbits.BIT という形式でビットの書き換えができないので、次の 2段作業とな
る。書き換え時点でのレジスタの値を知っておく必要は無い。

1. 書き換えたいビットをとりあえずクリアする
2. 書き換えたいビットに書き換える。

#1 には & (かつ) を使う。次の表の様に、残したいビットに 1、クリアしたいビットに 0 を指定し
て & 演算すれば、残したいところは残り、クリアしたいところだけクリアできる。

|     |     | 元    | ←    | コメント |
|     |     | 1     | 0     |          |
| --- | --- | ---   | ---   | ---      |
| 新  | 1   | **1** | **0** | 元が残る |
| ↑  | 0   |   0   |   0   | クリアできる |

#2 には | (または) を使う。今度は残したいビットに 0、立てたいビットに 1 を指定する。#1 で
クリアされたままで良いところは 0 とする。

|     |     | 元    | ←    | コメント |
|     |     | 1     | 0     |          |
| --- | --- | ---   | ---   | ---      |
| 新  | 1   |  1    | 1     | 新の値に |
| ↑  | 0   | **1** | **0** | 元のまま。または #1 でクリアしたまま |

## 例

REGISTER の下位 3ビットを 101 にしたいなら、

```
#1 とりあえず下位 3ビットをクリア
REGISTER = REGISTER & 0b11111000;

#2 下位 3ビットを指定
REGISTER = REGISTER | 0b00000101;
```
