# v1.0

AVR64DD28, PIC18F27Q43 と ADC 12bit だったので、今さら 10ビットには戻れない。
12bit ADC を持つルネサスマイコンは RL78/G23, G24 シリーズか、RA など他のシリーズ。

これまでが 28ピンマイコンだったけど、ルネサスマイコンは SSOP で 20ピンのものと 30ピンのも
のがあり、SQP だと 32 ピンのものがある。これまでの 28ピンマイコンで一度も 20ピンも使ったこ
とがないので 20ピンで良いだろう。


ということで、12ビット ADC と SSOP 20ピンというところから本機を選んだ。

RL78 シリーズはシリアル通信でプログラミングができるらしく、
Renesas Flash Programmer 対応マイコン表

https://www.renesas.com/ja/document/mat/list-mcus-supported-renesas-flash-programmer-v3?r=488871)

でも可となっている。1線式のタイプB と 2線式のタイプD が対応となるらしい。

1線式は

https://x.gd/IrZhp

の 4.2 節になる。TX にスリーステートバッファが入っている。

```
OE --+
 A --+--- Y
```

| OE (TX) | A (GND) | 出力 Y (TOOL0) |
| ---     | ---    | ---    |
| L | H | H |
| L | L | L |
| H | any | Z |

TOOL0 が入力状態 (Z状態) のとき、

- TX = L なら TOOL0 にも L が届く
- TX = H なら Z、つまり断線。RX はいつでも Z なはずだからプルアップされた TOOL0 には H が
  届く。

TOOL0 が送信状態 H のとき、TX の状態に関係なくプルアップされている RX には H が届く

TOOL0 が送信 L のとき、TX は L または断線 Z。つまり RX には L が届く。

これをスリーステートバッファじゃなくてダイオードを TX に向けて入れている方がいる。

https://x.gd/JyZcD

これもしかしてシリアル UPDI も同じ考えだったのでは？

RTS にインバータを噛ましているが、Frash Programmer のオプションにリセット信号を DTR, RTS,
反転、そのまま、の 4パターンから選択できるオプションがあるから DTR でも良いはず。

でここには タイプA,B,C しか記載がないが、おそらく タイプD は、このデバグ配線と思われる。D
は Debug ではないだろうか。

https://www.renesas.com/ja/document/apn/rl78-debugging-functions-using-serial-port-application-note

基本、これの図2.1 で良いと思う。図2.4 に Arduino でシリアルモニタを使うときの設定がある。
ぱっと見、プログラミングと UART のどちらでも使えそうに見えるが、TOOLRxD/TxD はあくまでプロ
グラミングやデバグモードでの通信であり、普通の UART はピンが別にある。

なので、これは Arduino を使っているときだけの仕組みだと思うので、図2.1 で良いだろう。

さて結局のところ、(腕的に)プログラマと UART は別ものとして使うことになりそうなので
(PIC18F27Q43 の時同様)、配線の簡素な 1線式で良いだろう。

UPDI のときはパリティ未対応の UART アダプタは使えなかったが、

https://www.renesas.com/ja/document/apn/rl78-flash-programmer-rl78-protocol-c-rev100

でパリティで検索すると、なし、と出てくるのでパリティの無い PIC16F1455 でも書き込める可能性
が出てきた。
(ていうか、USB 機能付きのやつであれば、UART アダプタ作れるんだろうな。ていうか E2 Lite と
か、中身ルネサスのマイコンなんだろうなあ。

なんかルネサスのマイコンって、個人が Lチカしてみた、みたいな記事はほとんどないけど、オフィ
シャルなドキュメントは、どれ読めば分からないだけで、豊富なんだな。シリアル通信でプログラミ
ングできるとか、個人趣味向け？いや DIP 版が無いからそれはないか。)

とハード面は大丈夫かなと思い e2 Stduio で Lチカを書いてビルドしても elf しかできない。うん
ソフト面で何もできないな。
